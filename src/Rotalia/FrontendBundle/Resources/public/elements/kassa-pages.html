<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-in-animation.html">
<link rel="import" href="../bower_components/neon-animation/animations/fade-out-animation.html">

<link rel="import" href="kassa-loading-page.html">
<link rel="import" href="kassa-behavior.html">

<dom-module id="kassa-pages">
    <template>
        <style>
            main {
                height: 100%;
                width: 100%;
                display: block;
                padding: 1em;
                overflow: auto;
                box-sizing: border-box;
                -webkit-box-sizing: border-box;
                -moz-box-sizing: border-box;
                -ms-box-sizing: border-box;
                -o-box-sizing: border-box;
            }

        </style>

        <main>
            <neon-animated-pages selected="[[shown]]" attr-for-selected="data-page" selected-item="{{selectedItem}}"
                                 entry-animation="fade-in-animation" exit-animation="fade-out-animation">
                <kassa-loading-page data-page="loading"></kassa-loading-page>
                <content></content>
            </neon-animated-pages>
        </main>

    </template>
    <script>
        Polymer({
            is: "kassa-pages",

            properties: {
                selected: {
                    type: String,
                    observer: '_onSelectedChange'
                },
                shown: {
                    type: String,
                    value: 'loading',
                    readOnly: true
                },
                selectedItem: {
                    type: Object,
                    observer: '_onPageChange'
                },
                height: {
                    type: Number,
                    observer: '_changeHeight'
                }
            },
            behaviors: [KassaBehavior],
            _onSelectedChange: function (newPage, oldPage) {
                this._setShown('loading');
                this.importHref(this.resolveUrl('kassa-' + newPage + '.html'), function(){
                    this._setShown(newPage);
                    this.fire('kassa-page-loaded');
                }, null, true);

            },
            _onPageChange: function (newPage, oldPage) {
                //kassa-page-behavior
                if(newPage && newPage.sharedSetUp){
                    newPage.sharedSetUp();
                }

                if(oldPage && oldPage.sharedCleanUp){
                    oldPage.sharedCleanUp();
                }
            },
            _changeHeight: function (newHeight) {
                this.$$('main').style.height = newHeight + 'px';
            }
        })
    </script>
</dom-module>
