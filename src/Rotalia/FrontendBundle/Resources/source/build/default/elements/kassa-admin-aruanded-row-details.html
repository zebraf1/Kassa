<html><head></head><body><dom-module id="kassa-admin-aruanded-row-details"><template><style>main{font-size:13px;padding-left:1em;width:100%;display:flex;flex-flow:row wrap;}table{border-spacing:0;}thead th, tbody td{text-align:right;padding:0.3em;}thead th:first-child, tbody td:first-child{text-align:left;}tbody tr:nth-child(odd){background-color:#e6e6e6;}tbody tr.red{background-color:#e6c3c5;}tbody tr.green{background-color:#c3e6cf;}table, kassa-aruanne-summary{margin:1em;}[hidden]{display:none;}</style><iron-ajax id="reportGet" url="/api/reports/[[item.id]]" loading="{{loading}}" handle-as="json" method="GET" content-type="application/x-www-form-urlencoded"></iron-ajax><main hidden$="[[isHidden]]"><paper-spinner active="" hidden$="[[!loading]]" style="height:25px; width: 25px; margin: 0 auto"></paper-spinner><table hidden$="[[loading]]"><thead><tr><th>Toode</th><th>Suurus</th><th>Hind</th><th>Alguses</th><th>Juurde</th><th>VÃ¤lja</th><th>Eeldatav</th><th>Tegelik</th></tr></thead><tbody><template is="dom-repeat" items="[[rows]]" as="row"><tr class$="[[row.style]]"><td>[[row.name]]</td><td>[[row.amount]]</td><td>[[eur2str(row.currentPrice)]]</td><td>[[row.startCount]]</td><td>[[row.inCount]]</td><td>[[row.outCount]]</td><td>[[row.estimatedCount]]</td><td>[[row.count]]</td></tr></template></tbody></table><kassa-aruanne-summary previous-report="[[_report.previousReport]]" updates="[[_updates]]" current-report="[[_report]]" target="[[item.target]]" flat="" hidden$="[[loading]]"></kassa-aruanne-summary></main></template><script>Polymer({is:'kassa-admin-aruanded-row-details',properties:{name:{type:String,value:'kassa-admin-aruanded'},rows:{type:Array},_report:{type:Object},_updates:{type:Object}},behaviors:[KassaBehavior,RowDetailsBehavior],rowActivated:function(b){this.$.reportGet.generateRequest().completes.then(function(c){var d=c.xhr.response.data;this.set('rows',this._computeRows(d.report,d.updates)),this.set('_report.cash',this.item.cash),this.$$('kassa-aruanne-summary').calcSummary(),this.async(function(){b()})}.bind(this))},_computeRows:function(b,c){this.set('_report',b),this.set('_updates',c);for(var f,d=[],e=0;e<b.reportRows.length;e++){if(f={},f.name=b.reportRows[e].product.name,f.amount=this.formatAmount(b.reportRows[e].product.amount,b.reportRows[e].product.amountType),f.startCount=0,this.isTrue(b.previousReport))for(var g=0;g<b.previousReport.reportRows.length;g++)if(b.reportRows[e].product.id===b.previousReport.reportRows[g].product.id){f.startCount=b.previousReport.reportRows[g].count;break}f.inCount=0,f.outCount=0,c.products.hasOwnProperty(b.reportRows[e].product.id)&&(f.inCount=c.products[b.reportRows[e].product.id].in,f.outCount=c.products[b.reportRows[e].product.id].out),f.estimatedCount=f.startCount+f.inCount-f.outCount,f.count=b.reportRows[e].count,f.currentPrice=b.reportRows[e].currentPrice,f.style='',f.count<f.estimatedCount?f.style='red':f.estimatedCount<f.count&&(f.style='green'),d.push(f)}return d}});</script></dom-module></body></html>