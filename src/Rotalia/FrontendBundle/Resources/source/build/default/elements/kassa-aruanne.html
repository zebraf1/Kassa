<html><head></head><body><div hidden="" by-polymer-bundler=""><script>Polymer.IronMultiSelectableBehaviorImpl={properties:{multi:{type:Boolean,value:!1,observer:'multiChanged'},selectedValues:{type:Array,notify:!0,value:function(){return[]}},selectedItems:{type:Array,readOnly:!0,notify:!0,value:function(){return[]}}},observers:['_updateSelected(selectedValues.splices)'],select:function(b){this.multi?this._toggleSelected(b):this.selected=b},multiChanged:function(b){this._selection.multi=b,this._updateSelected()},get _shouldUpdateSelection(){return null!=this.selected||null!=this.selectedValues&&this.selectedValues.length},_updateAttrForSelected:function(){this.multi?this.selectedItems&&0<this.selectedItems.length&&(this.selectedValues=this.selectedItems.map(function(b){return this._indexToValue(this.indexOf(b))},this).filter(function(b){return null!=b},this)):Polymer.IronSelectableBehavior._updateAttrForSelected.apply(this)},_updateSelected:function(){this.multi?this._selectMulti(this.selectedValues):this._selectSelected(this.selected)},_selectMulti:function(b){b=b||[];var c=(this._valuesToItems(b)||[]).filter(function(f){return null!==f&&f!==void 0});this._selection.clear(c);for(var d=0;d<c.length;d++)this._selection.setItemSelected(c[d],!0);if(this.fallbackSelection&&!this._selection.get().length){var e=this._valueToItem(this.fallbackSelection);e&&this.select(this.fallbackSelection)}},_selectionChange:function(){var b=this._selection.get();this.multi?(this._setSelectedItems(b),this._setSelectedItem(b.length?b[0]:null)):null!==b&&b!==void 0?(this._setSelectedItems([b]),this._setSelectedItem(b)):(this._setSelectedItems([]),this._setSelectedItem(null))},_toggleSelected:function(b){var c=this.selectedValues.indexOf(b);0>c?this.push('selectedValues',b):this.splice('selectedValues',c,1)},_valuesToItems:function(b){return null==b?null:b.map(function(c){return this._valueToItem(c)},this)}},Polymer.IronMultiSelectableBehavior=[Polymer.IronSelectableBehavior,Polymer.IronMultiSelectableBehaviorImpl];</script><script>Polymer.IronMenuBehaviorImpl={properties:{focusedItem:{observer:'_focusedItemChanged',readOnly:!0,type:Object},attrForItemTitle:{type:String},disabled:{type:Boolean,value:!1,observer:'_disabledChanged'}},_MODIFIER_KEYS:['Alt','AltGraph','CapsLock','Control','Fn','FnLock','Hyper','Meta','NumLock','OS','ScrollLock','Shift','Super','Symbol','SymbolLock'],_SEARCH_RESET_TIMEOUT_MS:1e3,_previousTabIndex:0,hostAttributes:{role:'menu'},observers:['_updateMultiselectable(multi)'],listeners:{focus:'_onFocus',keydown:'_onKeydown',"iron-items-changed":'_onIronItemsChanged'},keyBindings:{up:'_onUpKey',down:'_onDownKey',esc:'_onEscKey',"shift+tab:keydown":'_onShiftTabDown'},attached:function(){this._resetTabindices()},select:function(b){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null);var c=this._valueToItem(b);c&&c.hasAttribute('disabled')||(this._setFocusedItem(c),Polymer.IronMultiSelectableBehaviorImpl.select.apply(this,arguments))},_resetTabindices:function(){var b=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this.items.forEach(function(c){c.setAttribute('tabindex',c===b?'0':'-1')},this)},_updateMultiselectable:function(b){b?this.setAttribute('aria-multiselectable','true'):this.removeAttribute('aria-multiselectable')},_focusWithKeyboardEvent:function(b){if(-1===this._MODIFIER_KEYS.indexOf(b.key)){this.cancelDebouncer('_clearSearchText');var c=this._searchText||'',d=b.key&&1==b.key.length?b.key:String.fromCharCode(b.keyCode);c+=d.toLocaleLowerCase();for(var g,e=c.length,f=0;g=this.items[f];f++)if(!g.hasAttribute('disabled')){var h=this.attrForItemTitle||'textContent',j=(g[h]||g.getAttribute(h)||'').trim();if(!(j.length<e)&&j.slice(0,e).toLocaleLowerCase()==c){this._setFocusedItem(g);break}}this._searchText=c,this.debounce('_clearSearchText',this._clearSearchText,this._SEARCH_RESET_TIMEOUT_MS)}},_clearSearchText:function(){this._searchText=''},_focusPrevious:function(){for(var e,b=this.items.length,c=+this.indexOf(this.focusedItem),d=1;d<b+1;d++)if(e=this.items[(c-d+b)%b],!e.hasAttribute('disabled')){var f=Polymer.dom(e).getOwnerRoot()||document;if(this._setFocusedItem(e),Polymer.dom(f).activeElement==e)return}},_focusNext:function(){for(var e,b=this.items.length,c=+this.indexOf(this.focusedItem),d=1;d<b+1;d++)if(e=this.items[(c+d)%b],!e.hasAttribute('disabled')){var f=Polymer.dom(e).getOwnerRoot()||document;if(this._setFocusedItem(e),Polymer.dom(f).activeElement==e)return}},_applySelection:function(b,c){c?b.setAttribute('aria-selected','true'):b.removeAttribute('aria-selected'),Polymer.IronSelectableBehavior._applySelection.apply(this,arguments)},_focusedItemChanged:function(b,c){c&&c.setAttribute('tabindex','-1'),!b||b.hasAttribute('disabled')||this.disabled||(b.setAttribute('tabindex','0'),b.focus())},_onIronItemsChanged:function(b){b.detail.addedNodes.length&&this._resetTabindices()},_onShiftTabDown:function(){var c=this.getAttribute('tabindex');Polymer.IronMenuBehaviorImpl._shiftTabPressed=!0,this._setFocusedItem(null),this.setAttribute('tabindex','-1'),this.async(function(){this.setAttribute('tabindex',c),Polymer.IronMenuBehaviorImpl._shiftTabPressed=!1},1)},_onFocus:function(b){if(!Polymer.IronMenuBehaviorImpl._shiftTabPressed){var c=Polymer.dom(b).rootTarget;(c===this||'undefined'===typeof c.tabIndex||this.isLightDescendant(c))&&(this._defaultFocusAsync=this.async(function(){var d=this.multi?this.selectedItems&&this.selectedItems[0]:this.selectedItem;this._setFocusedItem(null),d?this._setFocusedItem(d):this.items[0]&&this._focusNext()}))}},_onUpKey:function(b){this._focusPrevious(),b.detail.keyboardEvent.preventDefault()},_onDownKey:function(b){this._focusNext(),b.detail.keyboardEvent.preventDefault()},_onEscKey:function(){var c=this.focusedItem;c&&c.blur()},_onKeydown:function(b){this.keyboardEventMatchesKeys(b,'up down esc')||this._focusWithKeyboardEvent(b),b.stopPropagation()},_activateHandler:function(b){Polymer.IronSelectableBehavior._activateHandler.call(this,b),b.stopPropagation()},_disabledChanged:function(b){b?(this._previousTabIndex=this.hasAttribute('tabindex')?this.tabIndex:0,this.removeAttribute('tabindex')):!this.hasAttribute('tabindex')&&this.setAttribute('tabindex',this._previousTabIndex)}},Polymer.IronMenuBehaviorImpl._shiftTabPressed=!1,Polymer.IronMenuBehavior=[Polymer.IronMultiSelectableBehavior,Polymer.IronA11yKeysBehavior,Polymer.IronMenuBehaviorImpl];</script><script>Polymer.IronMenubarBehaviorImpl={hostAttributes:{role:'menubar'},keyBindings:{left:'_onLeftKey',right:'_onRightKey'},_onUpKey:function(b){this.focusedItem.click(),b.detail.keyboardEvent.preventDefault()},_onDownKey:function(b){this.focusedItem.click(),b.detail.keyboardEvent.preventDefault()},get _isRTL(){return'rtl'===window.getComputedStyle(this).direction},_onLeftKey:function(b){this._isRTL?this._focusNext():this._focusPrevious(),b.detail.keyboardEvent.preventDefault()},_onRightKey:function(b){this._isRTL?this._focusPrevious():this._focusNext(),b.detail.keyboardEvent.preventDefault()},_onKeydown:function(b){this.keyboardEventMatchesKeys(b,'up down left right esc')||this._focusWithKeyboardEvent(b)}},Polymer.IronMenubarBehavior=[Polymer.IronMenuBehavior,Polymer.IronMenubarBehaviorImpl];</script><iron-iconset-svg name="paper-tabs" size="24"><svg><defs><g id="chevron-left"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"></path></g><g id="chevron-right"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></g></defs></svg></iron-iconset-svg><dom-module id="paper-tab" assetpath="../bower_components/paper-tabs/"><template><style>:host{@apply --layout-inline;@apply --layout-center;@apply --layout-center-justified;@apply --layout-flex-auto;position:relative;padding:0 12px;overflow:hidden;cursor:pointer;vertical-align:middle;@apply --paper-font-common-base;@apply --paper-tab;}:host(:focus){outline:none;}:host([link]){padding:0;}.tab-content{height:100%;transform:translateZ(0);-webkit-transform:translateZ(0);transition:opacity 0.1s cubic-bezier(0.4, 0.0, 1, 1);@apply --layout-horizontal;@apply --layout-center-center;@apply --layout-flex-auto;@apply --paper-tab-content;}:host(:not(.iron-selected)) > .tab-content{opacity:0.8;@apply --paper-tab-content-unselected;}:host(:focus) .tab-content{opacity:1;font-weight:700;}paper-ripple{color:var(--paper-tab-ink, var(--paper-yellow-a100));}.tab-content > ::slotted(a){@apply --layout-flex-auto;height:100%;}</style><div class="tab-content"><slot></slot></div></template><script>Polymer({is:'paper-tab',behaviors:[Polymer.IronControlState,Polymer.IronButtonState,Polymer.PaperRippleBehavior],properties:{link:{type:Boolean,value:!1,reflectToAttribute:!0}},hostAttributes:{role:'tab'},listeners:{down:'_updateNoink',tap:'_onTap'},attached:function(){this._updateNoink()},get _parentNoink(){var a=Polymer.dom(this).parentNode;return!!a&&!!a.noink},_updateNoink:function(){this.noink=!!this.noink||!!this._parentNoink},_onTap:function(b){if(this.link){var c=this.queryEffectiveChildren('a');if(!c)return;if(b.target===c)return;c.click()}}});</script></dom-module><dom-module id="paper-tabs" assetpath="../bower_components/paper-tabs/"><template><style>:host{@apply --layout;@apply --layout-center;height:48px;font-size:14px;font-weight:500;overflow:hidden;-moz-user-select:none;-ms-user-select:none;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);-webkit-tap-highlight-color:transparent;@apply --paper-tabs;}:host-context([dir=rtl]){@apply --layout-horizontal-reverse;}#tabsContainer{position:relative;height:100%;white-space:nowrap;overflow:hidden;@apply --layout-flex-auto;@apply --paper-tabs-container;}#tabsContent{height:100%;-moz-flex-basis:auto;-ms-flex-basis:auto;flex-basis:auto;@apply --paper-tabs-content;}#tabsContent.scrollable{position:absolute;white-space:nowrap;}#tabsContent:not(.scrollable),
      #tabsContent.scrollable.fit-container{@apply --layout-horizontal;}#tabsContent.scrollable.fit-container{min-width:100%;}#tabsContent.scrollable.fit-container > ::slotted(*){-ms-flex:1 0 auto;-webkit-flex:1 0 auto;flex:1 0 auto;}.hidden{display:none;}.not-visible{opacity:0;cursor:default;}paper-icon-button{width:48px;height:48px;padding:12px;margin:0 4px;}#selectionBar{position:absolute;height:0;bottom:0;left:0;right:0;border-bottom:2px solid var(--paper-tabs-selection-bar-color, var(--paper-yellow-a100));-webkit-transform:scale(0);transform:scale(0);-webkit-transform-origin:left center;transform-origin:left center;transition:-webkit-transform;transition:transform;@apply --paper-tabs-selection-bar;}#selectionBar.align-bottom{top:0;bottom:auto;}#selectionBar.expand{transition-duration:0.15s;transition-timing-function:cubic-bezier(0.4, 0.0, 1, 1);}#selectionBar.contract{transition-duration:0.18s;transition-timing-function:cubic-bezier(0.0, 0.0, 0.2, 1);}#tabsContent > ::slotted(:not(#selectionBar)){height:100%;}</style><paper-icon-button icon="paper-tabs:chevron-left" class$="[[_computeScrollButtonClass(_leftHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onLeftScrollButtonDown" tabindex="-1"></paper-icon-button><div id="tabsContainer" on-track="_scroll" on-down="_down"><div id="tabsContent" class$="[[_computeTabsContentClass(scrollable, fitContainer)]]"><div id="selectionBar" class$="[[_computeSelectionBarClass(noBar, alignBottom)]]" on-transitionend="_onBarTransitionEnd"></div><slot></slot></div></div><paper-icon-button icon="paper-tabs:chevron-right" class$="[[_computeScrollButtonClass(_rightHidden, scrollable, hideScrollButtons)]]" on-up="_onScrollButtonUp" on-down="_onRightScrollButtonDown" tabindex="-1"></paper-icon-button></template><script>Polymer({is:'paper-tabs',behaviors:[Polymer.IronResizableBehavior,Polymer.IronMenubarBehavior],properties:{noink:{type:Boolean,value:!1,observer:'_noinkChanged'},noBar:{type:Boolean,value:!1},noSlide:{type:Boolean,value:!1},scrollable:{type:Boolean,value:!1},fitContainer:{type:Boolean,value:!1},disableDrag:{type:Boolean,value:!1},hideScrollButtons:{type:Boolean,value:!1},alignBottom:{type:Boolean,value:!1},selectable:{type:String,value:'paper-tab'},autoselect:{type:Boolean,value:!1},autoselectDelay:{type:Number,value:0},_step:{type:Number,value:10},_holdDelay:{type:Number,value:1},_leftHidden:{type:Boolean,value:!1},_rightHidden:{type:Boolean,value:!1},_previousTab:{type:Object}},hostAttributes:{role:'tablist'},listeners:{"iron-resize":'_onTabSizingChanged',"iron-items-changed":'_onTabSizingChanged',"iron-select":'_onIronSelect',"iron-deselect":'_onIronDeselect'},keyBindings:{"left:keyup right:keyup":'_onArrowKeyup'},created:function(){this._holdJob=null,this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,this._bindDelayedActivationHandler=this._delayedActivationHandler.bind(this),this.addEventListener('blur',this._onBlurCapture.bind(this),!0)},ready:function(){this.setScrollDirection('y',this.$.tabsContainer)},detached:function(){this._cancelPendingActivation()},_noinkChanged:function(b){var c=Polymer.dom(this).querySelectorAll('paper-tab');c.forEach(b?this._setNoinkAttribute:this._removeNoinkAttribute)},_setNoinkAttribute:function(b){b.setAttribute('noink','')},_removeNoinkAttribute:function(b){b.removeAttribute('noink')},_computeScrollButtonClass:function(b,c,d){return!c||d?'hidden':b?'not-visible':''},_computeTabsContentClass:function(b,c){return b?'scrollable'+(c?' fit-container':''):' fit-container'},_computeSelectionBarClass:function(b,c){if(b)return'hidden';return c?'align-bottom':''},_onTabSizingChanged:function(){this.debounce('_onTabSizingChanged',function(){this._scroll(),this._tabChanged(this.selectedItem)},10)},_onIronSelect:function(b){this._tabChanged(b.detail.item,this._previousTab),this._previousTab=b.detail.item,this.cancelDebouncer('tab-changed')},_onIronDeselect:function(){this.debounce('tab-changed',function(){this._tabChanged(null,this._previousTab),this._previousTab=null},1)},_activateHandler:function(){this._cancelPendingActivation(),Polymer.IronMenuBehaviorImpl._activateHandler.apply(this,arguments)},_scheduleActivation:function(b,c){this._pendingActivationItem=b,this._pendingActivationTimeout=this.async(this._bindDelayedActivationHandler,c)},_delayedActivationHandler:function(){var b=this._pendingActivationItem;this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0,b.fire(this.activateEvent,null,{bubbles:!0,cancelable:!0})},_cancelPendingActivation:function(){this._pendingActivationTimeout!==void 0&&(this.cancelAsync(this._pendingActivationTimeout),this._pendingActivationItem=void 0,this._pendingActivationTimeout=void 0)},_onArrowKeyup:function(){this.autoselect&&this._scheduleActivation(this.focusedItem,this.autoselectDelay)},_onBlurCapture:function(b){b.target===this._pendingActivationItem&&this._cancelPendingActivation()},get _tabContainerScrollSize(){return Math.max(0,this.$.tabsContainer.scrollWidth-this.$.tabsContainer.offsetWidth)},_scroll:function(b,c){if(this.scrollable){var d=c&&-c.ddx||0;this._affectScroll(d)}},_down:function(){this.async(function(){this._defaultFocusAsync&&(this.cancelAsync(this._defaultFocusAsync),this._defaultFocusAsync=null)},1)},_affectScroll:function(b){this.$.tabsContainer.scrollLeft+=b;var c=this.$.tabsContainer.scrollLeft;this._leftHidden=0===c,this._rightHidden=c===this._tabContainerScrollSize},_onLeftScrollButtonDown:function(){this._scrollToLeft(),this._holdJob=setInterval(this._scrollToLeft.bind(this),this._holdDelay)},_onRightScrollButtonDown:function(){this._scrollToRight(),this._holdJob=setInterval(this._scrollToRight.bind(this),this._holdDelay)},_onScrollButtonUp:function(){clearInterval(this._holdJob),this._holdJob=null},_scrollToLeft:function(){this._affectScroll(-this._step)},_scrollToRight:function(){this._affectScroll(this._step)},_tabChanged:function(b,c){if(!b)return this.$.selectionBar.classList.remove('expand'),this.$.selectionBar.classList.remove('contract'),void this._positionBar(0,0);var d=this.$.tabsContent.getBoundingClientRect(),f=d.width,g=b.getBoundingClientRect(),h=g.left-d.left;if(this._pos={width:this._calcPercent(g.width,f),left:this._calcPercent(h,f)},this.noSlide||null==c)return this.$.selectionBar.classList.remove('expand'),this.$.selectionBar.classList.remove('contract'),void this._positionBar(this._pos.width,this._pos.left);var i=c.getBoundingClientRect(),j=this.items.indexOf(c),k=this.items.indexOf(b),n=5;this.$.selectionBar.classList.add('expand');var o=j<k,p=this._isRTL;p&&(o=!o),o?this._positionBar(this._calcPercent(g.left+g.width-i.left,f)-n,this._left):this._positionBar(this._calcPercent(i.left+i.width-g.left,f)-n,this._calcPercent(h,f)+n),this.scrollable&&this._scrollToSelectedIfNeeded(g.width,h)},_scrollToSelectedIfNeeded:function(b,c){var d=c-this.$.tabsContainer.scrollLeft;0>d?this.$.tabsContainer.scrollLeft+=d:(d+=b-this.$.tabsContainer.offsetWidth,0<d&&(this.$.tabsContainer.scrollLeft+=d))},_calcPercent:function(b,c){return 100*b/c},_positionBar:function(b,c){b=b||0,c=c||0,this._width=b,this._left=c,this.transform('translateX('+c+'%) scaleX('+b/100+')',this.$.selectionBar)},_onBarTransitionEnd:function(){var c=this.$.selectionBar.classList;c.contains('expand')?(c.remove('expand'),c.add('contract'),this._positionBar(this._pos.width,this._pos.left)):c.contains('contract')&&c.remove('contract')}});</script></dom-module><dom-module id="kassa-aruanne-sularaha"><template><style>main{width:16em;}.raha-all{display:flex;flex-flow:column wrap;}.raha{display:flex;flex-flow:row nowrap;align-items:baseline;width:15em;}.raha span:first-child{flex:0 0 6em;}.raha span:last-child{flex:1 0 5em;text-align:right;}paper-input{width:5em;}</style><kassa-material direction="vertical"><h4>Sularaha varem välja võetud:</h4><span>[[_calcCashOut(cashUpdates)]]</span><h4>Sularaha nüüd välja võetud:</h4><paper-input type="number" value="{{cashOut}}" step="0.01" disabled="[[fixed]]" no-label-float=""><span slot="suffix">€</span></paper-input><h3>[[strings.title]]:</h3><div class="raha-all"><template is="dom-repeat" items="{{bills}}" as="bill"><div class="raha"><span>[[eur2str(bill.value)]] ×</span><paper-input value="{{bill.count}}" type="number" step="1" min="0" on-change="_computeCash" disabled="[[fixed]]" no-label-float=""></paper-input><span>= [[_computeBillSum(bill.value, bill.count)]]</span></div></template><div><h4>Kokku:</h4><span>[[eur2str(cash)]]</span></div></div><paper-button on-tap="_confirmCash" style="align-self: flex-end" disabled="[[fixed]]">Edasi</paper-button></kassa-material></template><script>Polymer({is:'kassa-aruanne-sularaha',properties:{cash:{type:Number,value:0,notify:!0,readOnly:!0},cashOut:{type:Number,value:0,notify:!0},cashUpdates:{type:Object},fixed:{type:Boolean,value:!1},target:{type:String},bills:{type:Array,value:function(){for(var b=[],c=[500,200,100,50,20,10,5,2,1,0.5,0.2,0.1,0.05,0.02,0.01],d=0;d<c.length;d++)b.push({value:c[d],count:0});return b}},strings:{type:Object,computed:'_computeStrings(target)'}},behaviors:[KassaBehavior],reset:function(){this.set('cashOut',0),this.set('bills',this.properties.bills.value())},_computeBillSum:function(b,c){return this.eur2str(b*c)},_computeCash:function(){for(var b=0,c=0;c<this.bills.length;c++)b+=this.bills[c].value*this.bills[c].count;this._setCash(b)},_confirmCash:function(){this.fire('cash-confirmed')},_computeStrings:function(b){return'storage'===b?{title:'Sularaha kassas'}:'warehouse'===b?{title:'Sularaha laos'}:void 0},_calcCashOut:function(b){return void 0===b?this.eur2str(0):this.eur2str(b.out-b.in)}});</script></dom-module><dom-module id="kassa-aruanne-summary"><template><style>table{max-width:30em;}.sub-row{color:#888888;}.sub-row td:first-child{padding-left:1em;}td:last-child{text-align:right;padding-left:1em;}.border-top td{border-top:1px solid #000;}td{margin:0.1em 0;}.buttons{display:flex;flex-flow:row wrap;}.buttons kassa-confirm-button{margin-left:auto;}</style><kassa-material><h3>Kokkuvõte</h3><table><tbody><tr><td>Kassa väärtus alguses</td><td>[[eur2str(_valueStart)]]</td></tr><tr class="sub-row"><td>Tooted</td><td>[[eur2str(_productsStart)]]</td></tr><tr class="sub-row"><td>Sularaha</td><td>[[eur2str(cashStart)]]</td></tr><tr><td>Juurde lisatud</td><td>[[eur2str(_valueIn)]]</td></tr><tr class="sub-row"><td>Tooted</td><td>[[eur2str(_productsIn)]]</td></tr><tr class="sub-row"><td>Sularaha</td><td>[[_totalCashUpdates(cashUpdates)]]</td></tr><tr><td>Krediidiga ostud</td><td>[[eur2str(_creditPurchases)]]</td></tr><tr class="border-top"><td>Eeldatav väärtus</td><td>[[eur2str(_valueEstimated)]]</td></tr><tr><td>Tegelik väärtus</td><td>[[eur2str(_valueEnd)]]</td></tr><tr class="sub-row"><td>Tooted</td><td>[[eur2str(_productsEnd)]]</td></tr><tr class="sub-row"><td>Sularaha</td><td>[[eur2str(cashEnd)]]</td></tr><tr><td>[[_computeDeficitText(_deficit)]]</td><td>[[_computeDeficitNumb(_deficit)]]</td></tr></tbody></table><div class="buttons"><paper-button raised="" disabled="[[_isRequestLoading]]" on-tap="_editReport">Paranda</paper-button><kassa-confirm-button style="margin-right: 16px" confirmed="{{_isRequestLoading}}" on-kassa-confirm="_confirmReport">Salvesta</kassa-confirm-button></div></kassa-material></template><script>Polymer({is:'kassa-aruanne-summary',properties:{cashStart:{type:Number},cashUpdates:{type:Object},cashEnd:{type:Number},products:{type:Array},target:{type:String},_valueStart:{type:Number},_valueIn:{type:Number},_valueEstimated:{type:Number},_valueEnd:{type:Number},_deficit:{type:Number},_productsStart:{type:Number},_productsIn:{type:Number},_creditPurchases:{type:Number},_productsEnd:{type:Number}},behaviors:[KassaBehavior],calcSummary:function(){this.cashStart===void 0&&this.set('cashStart',0);for(var b=0,c=0,d=0,e=0,f=0;f<this.products.length;f++)b+=this.products[f].previousCount*this.products[f].price,c+=this.products[f].updates.in*this.products[f].price,d+=this.products[f].updates.out*this.products[f].price,e+=this.products[f].count*this.products[f].price;this.set('_valueStart',b+this.cashStart),this.set('_valueIn',c+this.cashUpdates.in-this.cashUpdates.out),this.set('_valueEstimated',this._valueStart+this._valueIn-d),this.set('_valueEnd',e+this.cashEnd),this.set('_deficit',this._valueEstimated-this._valueEnd),this.set('_productsStart',b),this.set('_productsIn',c),this.set('_creditPurchases',d),this.set('_productsEnd',e)},reset:function(){this.$$('kassa-confirm-button').reset()},_totalCashUpdates:function(b){return this.eur2str(b.in-b.out)},_confirmReport:function(){this.fire('report-confirmed')},_editReport:function(){this.fire('report-edit')},_computeDeficitText:function(b){return 0<=b?'Puuduj\xE4\xE4k':'\xDClej\xE4\xE4k'},_computeDeficitNumb:function(b){return this.eur2str(Math.abs(b))}});</script></dom-module><link ref="import" href="../bower_components/paper-button/paper-button.html"><link ref="import" href="../bower_components/paper-input/paper-input.html"><link ref="import" href="../bower_components/paper-icon-button/paper-icon-button.html"><dom-module id="kassa-aruanne-toode"><template><style>:host{flex:1 1 21em;margin:0.2em;}#top{display:flex;flex-flow:row wrap;justify-content:space-between;}#left{display:flex;flex-flow:column nowrap;flex:1 0 auto;padding-bottom:2em;}#left span:first-child{font-size:1.5em;}#left paper-icon-button{--paper-icon-button:{color:#aaaaaa;};}#right{display:flex;flex-flow:column nowrap;flex:0 0 7em;margin-left:auto;}#right div{display:flex;flex-flow:row nowrap;justify-content:space-between;padding:0.1em;}#right div span{display:block;flex:0 0 2.5em;text-align:right;}#right div span:first-child{flex:1 0 auto;text-align:left;}#bottom div{display:flex;justify-content:center;align-items:center;border-top:1px solid #aaaaaa;padding:0.5em;}.borderbottom{border-bottom:1px solid #000;}.striketrough{text-decoration:line-through;}[data-invisible]{visibility:hidden;}[hidden]{display:none !important;}</style><kassa-material><div id="top"><div id="left"><span>[[product.name]]</span> <span>Suurus: [[formatAmount(product.amount, product.amountType)]]</span> <span>Hind: [[eur2str(product.price)]]</span><paper-icon-button icon="kassa:edit" hidden$="[[_computeEditIconHidden(confirmed, editing, fixed)]]" on-tap="_editKogus"></paper-icon-button></div><div id="right"><div><span>Eelmises:</span> <span>[[product.previousCount]]</span></div><div><span>[[strings.in]]:</span> <span>+[[product.updates.in]]</span></div><div class="borderbottom"><span>[[strings.out]]:</span> <span>-[[product.updates.out]]</span></div><div class$="[[_computeKapisClass(product.estimatedCount, product.count)]]"><span>[[strings.count]]:</span> <span>[[product.estimatedCount]]</span></div><div data-invisible$="[[_computeTegelikHidden(product.estimatedCount, product.count)]]"><span>Tegelikult:</span> <span>[[product.count]]</span></div></div></div><div id="bottom" hidden$="[[fixed]]"><div hidden$="[[confirmed]]"><paper-button on-tap="_editKogus">Kogus Vale</paper-button><paper-button on-tap="_confirmKogus">Kogus Õige</paper-button></div><div hidden$="[[!editing]]"><paper-input label="Tegelik kogus" type="number" min="0" step="1" value="{{product.count}}" id="currentCount" on-focusin="_onFocusinSelect"></paper-input><paper-button on-tap="_confirmKogus">Edasi</paper-button></div></div></kassa-material></template><script>Polymer({is:'kassa-aruanne-toode',properties:{product:{type:Object,value:{},notify:!0},confirmed:{type:Boolean,value:!1,readOnly:!0},editing:{type:Boolean,value:!1,readOnly:!0},fixed:{type:Boolean,value:!1},target:{type:String},strings:{type:Object,computed:'_computeStrings(target)'}},behaviors:[KassaBehavior],_computeEditIconHidden:function(b,c,d){return!b||c||d},_computeTegelikHidden:function(b,c){return b===parseInt(c)},_computeKapisClass:function(b,c){return b===parseInt(c)?'':'striketrough'},_confirmKogus:function(){this._setConfirmed(!0),this._setEditing(!1),this.fire('kogus-confirmed')},_editKogus:function(){this._setConfirmed(!0),this._setEditing(!0),this.$.currentCount.focus()},_onFocusinSelect:function(b){var c=b.target||b.srcElement;c.inputElement.inputElement.select()},_computeStrings:function(b){return'storage'===b?{in:'Lisatud',out:'ostetud',count:'Kapis'}:'warehouse'===b?{in:'Sisse',out:'Kappi',count:'Laos'}:void 0}});</script></dom-module></div><dom-module id="kassa-aruanne"><template><style>main{padding-bottom:500px;}paper-tabs{--paper-tabs-selection-bar-color:var(--kassa-secondary-color);margin-bottom:1em;}paper-tab{--paper-tab-ink:var(--kassa-secondary-color);}#items{display:flex;flex-flow:row wrap;}#tail{display:flex;flex-flow:row wrap;}#tail > *{flex:0 1 auto;margin:0.5em;}[hidden]{display:none;}</style><main><kassa-material direction="vertical"><paper-tabs selected="{{selectedTarget}}" hidden$="[[!hasRights(member, 'ROLE_ADMIN', conventId)]]" no-slide=""><paper-tab>Valvearuanne</paper-tab><paper-tab>Lao inventuur</paper-tab></paper-tabs><span>[[_computeGreeting(lastReport)]]</span></kassa-material><div id="items"><template is="dom-repeat" items="{{mergedProducts}}" as="product" on-dom-change="setColumnWidths"><kassa-aruanne-toode kassa-columns-item="" product="{{product}}" fixed="[[reportFixed]]" target="[[target]]" hidden$="[[_isProductHidden(index, lastIndex)]]" on-kogus-confirmed="_countConfirmed"></kassa-aruanne-toode></template></div><div id="tail"><kassa-aruanne-sularaha fixed="[[reportFixed]]" target="[[target]]" cash-updates="[[updates.cash]]" cash="{{cash}}" cash-out="{{cashOutNow}}" hidden$="[[_cashHidden(lastIndex, products)]]" on-cash-confirmed="_onCashConfirmed"></kassa-aruanne-sularaha><kassa-aruanne-summary products="[[products]]" cash-start="[[lastReport.cash]]" cash-updates="[[_combineCashUpdates(updates.cash, cashOutNow)]]" cash-end="[[cash]]" target="[[target]]" on-report-confirmed="_confirmReport" on-report-edit="_editReport" hidden$="[[!reportFixed]]"></kassa-aruanne-summary></div></main></template><script>Polymer({is:'kassa-aruanne',properties:{conventId:{type:Number},member:{type:Object},lastReport:{type:Object},updates:{type:Object},products:{type:Array},productGroups:{type:Array},mergedProducts:{type:Array,computed:'_mergeProducts(products, lastReport, updates, productGroups)'},target:{type:String,computed:'_computeTarget(selectedTarget, member, conventId)'},selectedTarget:{type:Number,value:0},lastIndex:{type:Number,value:0},reportFixed:{type:Boolean,value:!1},cash:{type:Number}},behaviors:[PageBehavior,KassaBehavior,EqualColumnsBehavior],observers:['_loadProducts(pageActive, conventId)','_loadLastReport(pageActive, conventId, target)'],setUp:function(){this.productGroups===void 0&&this.fire('kassa-backend-action',{action:'doProductGroupsGet'})},cleanUp:function(){this.set('lastIndex',0),this.set('products',void 0),this.set('updates',void 0),this.set('reportFixed',!1)},_loadProducts:function(d,e){d&&e!==void 0&&(this.set('products',void 0),this.fire('kassa-backend-action',{action:'doProductsGetActive',conventId:e}))},_loadLastReport:function(d,e,f){d&&e!==void 0&&f!==void 0&&(this.fire('kassa-page-loading'),this.set('lastIndex',0),this.set('updates',void 0),this.set('reportFixed',!1),this.fire('kassa-backend-action',{action:'doSingleReportGet',id:-1,conventId:e,target:f,reportType:'VERIFICATION',onSuccess:function(){this.fire('kassa-page-ready',{page:this})}.bind(this)}))},_computeTarget:function(d,e,f){return this.hasRights(e,'ROLE_ADMIN',f)?['storage','warehouse'][parseInt(d)]:'storage'},_computeGreeting:function(d){if(d!==void 0)return this.isTrue(d)?'Eelmise aruande koostas '+d.member+' '+d.createdAt:'Seda t\xFC\xFCpi aruannet pole siin konvendis veel koostatud'},_mergeProducts:function(d,e,f,g){var h=[];if(d!==void 0&&e!==void 0&&f!==void 0&&g!==void 0){for(var l,k=0;k<d.length;k++){if(l=d[k],l.updates=void 0===f.products||void 0===f.products[l.id]?{in:0,out:0}:f.products[l.id],l.previousCount=0,this.isTrue(e))for(var m=0;m<e.reportRows.length;m++)if(e.reportRows[m].product.id===d[k].id){l.previousCount=e.reportRows[m].count;break}l.estimatedCount=l.previousCount+l.updates['in']-l.updates.out,l.count=l.estimatedCount,h.push(l)}var n=g.map(function(o){return o.id});h=h.sort(function(o,p){var q=n.indexOf(o.productGroupId);-1===q&&(q=n.length);var r=n.indexOf(p.productGroupId);return-1===r&&(r=n.length),q-r})}return h},_isProductHidden:function(d,e){return d>e},_countConfirmed:function(d){d.model.index===this.lastIndex&&this.set('lastIndex',this.lastIndex+1)},_cashHidden:function(d,e){return!(void 0!==e)||d<e.length},_onCashConfirmed:function(){this.set('reportFixed',!0),this.$$('kassa-aruanne-summary').calcSummary()},_combineCashUpdates:function(d,e){return void 0===d&&(d={in:0,out:0}),{in:d['in']-parseFloat(e),out:d.out}},_editReport:function(){this.set('reportFixed',!1)},_confirmReport:function(){var d=this;this.fire('kassa-backend-action',{action:'doReportPost',conventId:this.conventId,cashOut:this.cashOutNow,Report:{cash:this.cash,target:this.target,reportRows:this.products.map(function(e){return d.pickProperties(e,['id','count'],['productId','count'])})},onSuccess:function(){this.$$('kassa-aruanne-summary').reset(),this.$$('kassa-aruanne-sularaha').reset(),this._loadProducts(this.pageActive,this.conventId),this._loadLastReport(this.pageActive,this.conventId,this.target)}.bind(this),onError:function(){this.$$('kassa-aruanne-summary').reset(),this.set('reportFixed',!1)}.bind(this)})}});</script></dom-module></body></html>