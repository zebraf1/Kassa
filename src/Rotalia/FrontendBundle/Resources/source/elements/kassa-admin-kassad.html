<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">

<link rel="import" href="kassa-page-behavior.html">
<link rel="import" href="kassa-behavior.html">
<link rel="import" href="kassa-table.html">
<link rel="import" href="kassa-confirm-button.html">

<dom-module id="kassa-admin-kassad">
    <template>
        <style>
        </style>
        <kassa-table items="[[pointOfSales]]" dialog="[[dialog]]" convent-id="[[conventId]]" scroll-target="[[scrollTarget]]"
                     add-func="doPointOfSalesPost" edit-func="doPointOfSalesPatch"  delete-func="doPointOfSalesDelete">
            <vaadin-grid-column flex-grow="0">
                <template class="header">Id</template>
                <template>
                    <span>[[item.id]]</span>
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column flex-grow="10"  filter-by="name">
                <template class="header">
                    <vaadin-grid-filter path="name" value="{{_nameFilter}}">
                        <paper-input label="Nimi" value="{{_nameFilter}}"></paper-input>
                    </vaadin-grid-filter>
                </template>
                <template> 
                    <span>[[item.name]]</span>
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column flex-grow="1">
                <template class="header">Konvent</template>
                <template>
                    <span>[[mapIdToValue(item.conventId, activeConvents, 'name')]]</span>
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column flex-grow="1">
                <template class="header">Looja</template>
                <template>
                    <span>[[item.createdBy]]</span>
                </template>
            </vaadin-grid-column>
            <vaadin-grid-column flex-grow="5">
                <template class="header">Loodud</template>
                <template>
                    <span>[[item.createdAt]]</span>
                </template>
            </vaadin-grid-column>
        </kassa-table>

        <paper-dialog id="dialog" modal style="max-width: 350px">
            <paper-material class="spilt-v">
                <div class="split-h"><paper-input data-field="name" label="Nimi" type="text"></paper-input></div>
            </paper-material>
            <div class="buttons">
                <paper-button dialog-dismiss raised>Sulge</paper-button>
                <kassa-confirm-button>Salvesta</kassa-confirm-button>
            </div>
        </paper-dialog>


    </template>
    <script>
        Polymer({
            is: "kassa-admin-kassad",
            properties: {
                pointOfSales: {
                    type: Array
                },
                activeConvents: {
                    type: Array
                },
                dialog: {
                    type: Node,
                    value: function() {
                        return this.$.dialog
                    }
                },
                conventId: {
                    type: Number
                }
            },
            behaviors: [PageBehavior, KassaBehavior],
            setUp: function() {
                this.fire('kassa-backend-action', {action: 'doPointOfSalesGet'});
            }
        })
    </script>
</dom-module>



