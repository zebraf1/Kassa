<?xml version="1.0" encoding="UTF-8"?>
<database name="default" namespace="Rotalia\InventoryBundle\Model" defaultIdMethod="native">
    <table name="ollekassa_product" phpName="Product">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true" />
        <column name="name" type="VARCHAR" size="100" required="true" />
        <column name="product_code" type="VARCHAR" size="100" required="false" />
        <column name="price" type="DECIMAL" size="10" scale="2" required="true" />
        <column name="amount_type_id" type="VARCHAR" size="50" defaultValue="PIECE" />
        <column name="status_id" type="VARCHAR" size="50" defaultValue="ACTIVE" />
        <column name="seq" type="INTEGER" size="3" defaultValue="1" />
        <vendor type="mysql">
            <parameter name="Engine" value="InnoDB"/>
            <parameter name="Charset" value="utf8"/>
        </vendor>
    </table>

    <table name="ollekassa_report" phpName="Report">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true" />
        <column name="name" type="VARCHAR" size="100" required="true" />
        <column name="member_id" type="INTEGER" />
        <column name="cash" type="DECIMAL" size="10" scale="2" required="true" />
        <column name="type" type="VARCHAR" required="true" defaultValue="VERIFICATION" />
        <index name="member_id">
            <index-column name="member_id"/>
        </index>
        <foreign-key foreignTable="liikmed" name="report_member_fk" skipSql="true">
            <reference local="member_id" foreign="id" />
        </foreign-key>
        <vendor type="mysql">
            <parameter name="Engine" value="InnoDB"/>
            <parameter name="Charset" value="utf8"/>
        </vendor>
        <behavior name="timestampable" />
    </table>

    <table name="ollekassa_report_row" phpName="ReportRow">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true" />
        <column name="report_id" type="INTEGER" required="false" />
        <column name="product_id" type="INTEGER" required="false" />
        <column name="amount" type="DECIMAL" size="10" scale="1" required="true" defaultValue="0" />
        <column name="current_price" type="DECIMAL" size="10" scale="2" required="false" />
        <foreign-key foreignTable="ollekassa_product" name="report_row_product_fk" onDelete="CASCADE">
            <reference local="product_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="ollekassa_report" name="report_row_report_fk" onDelete="CASCADE">
            <reference local="report_id" foreign="id" />
        </foreign-key>
        <vendor type="mysql">
            <parameter name="Engine" value="InnoDB"/>
            <parameter name="Charset" value="utf8"/>
        </vendor>
    </table>

    <table name="ollekassa_transaction" phpName="Transaction">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true" />
        <column name="type" type="VARCHAR" required="true" />
        <column name="product_id" type="INTEGER" required="false" />
        <column name="member_id" type="INTEGER" required="true" />
        <column name="amount" type="DECIMAL" size="10" scale="1" required="false" />
        <column name="current_price" type="DECIMAL" size="10" scale="2" required="false" />
        <column name="sum" type="DECIMAL" size="10" scale="2" required="true" />
        <column name="created_at" type="TIMESTAMP" required="true" defaultExpr="CURRENT_TIMESTAMP"/>
        <column name="created_by" type="INTEGER" required="true" />
        <index name="member_id">
            <index-column name="member_id"/>
        </index>
        <foreign-key foreignTable="ollekassa_product" name="product_purchase_product_fk">
            <reference local="product_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="liikmed" name="product_purchase_member_fk" skipSql="true">
            <reference local="member_id" foreign="id" />
        </foreign-key>
        <foreign-key foreignTable="liikmed" name="product_purchase_created_by_fk" skipSql="true">
            <reference local="created_by" foreign="id" />
        </foreign-key>
        <vendor type="mysql">
            <parameter name="Engine" value="InnoDB"/>
            <parameter name="Charset" value="utf8"/>
        </vendor>
    </table>

    <table name="ollekassa_point_of_sale" phpName="PointOfSale">
        <column name="id" type="INTEGER" required="true" primaryKey="true" autoIncrement="true" />
        <column name="name" type="VARCHAR" size="100" required="true" />
        <column name="hash" type="VARCHAR" size="100" required="true" />
        <column name="device_info" type="VARCHAR" size="255" required="false" />
        <column name="created_at" type="TIMESTAMP" required="true" defaultExpr="CURRENT_TIMESTAMP"/>
        <column name="created_by" type="INTEGER" required="true" />
        <foreign-key foreignTable="liikmed" name="pos_created_by_fk" skipSql="true">
            <reference local="created_by" foreign="id" />
        </foreign-key>
        <vendor type="mysql">
            <parameter name="Engine" value="InnoDB"/>
            <parameter name="Charset" value="utf8"/>
        </vendor>
    </table>
</database>
